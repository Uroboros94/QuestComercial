///$tab Main
SET ThousandSep='.';
SET DecimalSep=',';
SET MoneyThousandSep='.';
SET MoneyDecimalSep=',';
SET MoneyFormat='$#.##0,00;-$#.##0,00';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='DD/MM/YYYY';
SET TimestampFormat='DD/MM/YYYY h:mm:ss[.fff] TT';
SET MonthNames='ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sep.;oct.;nov.;dic.';
SET DayNames='lun.;mar.;mié.;jue.;vie.;sáb.;dom.';
SET LongMonthNames='enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiembre;octubre;noviembre;diciembre';
SET LongDayNames='lunes;martes;miércoles;jueves;viernes;sábado;domingo';
SET FirstWeekDay=0;
SET BrokenWeeks=1;
SET ReferenceDay=0;
SET FirstMonthOfYear=1;
SET CollationLocale='es-CO';

///$tab Calendario
QUALIFY *;
UNQUALIFY SK.FECHA;
Calendario:
LOAD num(Fecha)				AS SK.FECHA,
//	 num(Fecha)				AS SK.FECHA1,
     Año					AS ano, 
     Mes					as nomMes, 
     MonthYear, 
     %_Fechakey, 
     NumericMonthYear, 
     NumericMonth, 
     Semestre, 
     Trimestre				as nomTrim,
     trimestre, 
     Week					as semana,
     SemanaMes, 
     Weekday				as nombreDia, 
     Dia					as dia, 
     DateMMDD,
     CYTD,
     FPYTD,
     Festivo, 
     EsFestivo
FROM
[..\QVD\Calendario_Final.QVD]
(qvd)
WHERE Fecha >= '01/01/2016';

UNQUALIFY *;
///$tab OrdenesProduccion
OrdenesProduccion_tmp:
LOAD 
	 PROJLINKEDTOORDER, 
     ITEMID, 
     NAME, 
     PRODGROUPID, 
     PRODSTATUS, 
     PRODPRIO, 
     PRODLOCKED, 
     PRODTYPE, 
     SCHEDSTATUS, 
     SCHEDDATE, 
     QTYSCHED, 
     QTYSTUP, 
     DLVDATE, 
     STUPDATE, 
     FINISHEDDATE, 
     SCHEDSTART, 
     SCHEDEND, 
     DEFAULTDIMENSION, 
     HEIGHT, 
     WIDTH, 
     DEPTH, 
     DENSITY, 
     QTYCALC, 
     REALDATE, 
     RESERVATION, 
     PRODPOSTINGTYPE, 
     INVENTTRANSID, 
     INVENTREFTYPE, 
     INVENTREFID, 
     INVENTREFTRANSID, 
     COLLECTREFLEVEL, 
     COLLECTREFPRODID, 
     BOMDATE, 
     BACKORDERSTATUS, 
     PRODPOOLID, 
     PROFITSET, 
     CALCDATE, 
     ROUTEJOBS, 
     CHECKROUTE, 
     PROPERTYID, 
     REMAININVENTPHYSICAL, 
     BOMID, 
     ROUTEID, 
     REQPLANIDSCHED, 
     REQPOID, 
     REFLOOKUP, 
     LATESTSCHEDDIRECTION, 
     LATESTSCHEDDATE, 
     PRODID, 
     INVENTDIMID, 
     SCHEDTOTIME, 
     SCHEDFROMTIME, 
     LATESTSCHEDTIME, 
     DLVTIME, 
     PRODORIGID, 
     GANTTCOLORID, 
     PROJID, 
     PROJPOSTINGTYPE, 
     PROJCATEGORYID, 
     PROJLINEPROPERTYID, 
     PROJTRANSID, 
     PROJCOSTPRICE, 
     PROJCOSTAMOUNT, 
     PROJSALESCURRENCYID, 
     PROJSALESUNITID, 
     PROJSALESPRICE, 
     PROJTAXGROUPID, 
     PROJTAXITEMGROUPID, 
     ACTIVITYNUMBER, 
     PRICEGROUP_RU, 
     CURRENCYCODE_RU, 
     PBAID, 
     PMFTOTALCOSTALLOCATION, 
     PDSCWBATCHEST, 
     PDSCWBATCHSCHED, 
     PDSCWBATCHSIZE, 
     PDSCWBATCHSTUP, 
     PDSCWREMAININVENTPHYSICAL, 
     PMFBULKORD, 
     PMFCOBYVARALLOW, 
     PMFCONSORDID, 
     PMFREWORKBATCH, 
     PMFYIELDPCT, 
     PRODWHSRELEASEPOLICY, 
     RELEASEDDATE, 
     CREATEDDATETIME, 
     DEL_CREATEDTIME, 
     CREATEDBY, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     AP_QST_MASTERPRODORDID, 
     AP_QST_PROCESSNAME, 
     AP_QST_OPRNUM, 
     AP_QST_MOVJOURNALID, 
     AP_QST_SALESID
FROM
[..\QVD\OrdenesProduccion.QVD]
(qvd);
Left Join 
LOAD INVENTDIMID, 
     INVENTSIZEID, 
     INVENTCOLORID
FROM
[..\QVD\InventDim.QVD]
(qvd);
Left Join
ProdStatus:
LOAD * INLINE [
    PRODSTATUS, PRODSTATUSNAME
    0, Creado
    1, Estimada
    2, Programado
    3, Liberado
    4, Iniciado
    5, Notificado como Terminado
    7, Terminado
];
Left Join
ProduTableJour:
LOAD PRODID, 
//     ITEMID, 
//     INVENTTRANSID, 
//     TRANSDATE, 
//     JOURNALTYPE, 
     QTYGOOD 
//     VOUCHER, 
//     AMOUNTFINANCIAL, 
//     ADJUSTMENT, 
//     QTYERROR, 
//     AMOUNTPHYSICAL, 
//     SCRAPVOUCHER, 
//     CANCELED, 
//     OPENPRODORDER, 
//     AMOUNTFINANCIALSECCUR_RU, 
//     PDSCWBATCHERR, 
//     PDSCWBATCHGOOD, 
//     MODIFIEDDATETIME, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID
FROM
[..\QVD\ProdTableJour.QVD]
(qvd)
where JOURNALTYPE=3;



QUALIFY *;
UNQUALIFY %OrdenesProduccionKey,%KEYPRODUCT,%DEFAULTDIMENSION,COLLECTREFPRODID,PRODID,%FECHAKEY;
NoConcatenate
OrdenesProduccion:
LOAD 
	 AutoNumber(RecNo())		as %OrdenesProduccionKey,
	 PROJLINKEDTOORDER, 
     ITEMID,
     INVENTSIZEID, 
     INVENTCOLORID,
     ITEMID&INVENTSIZEID&INVENTCOLORID as %KEYPRODUCT,
     NAME, 
     PRODGROUPID, 
     PRODSTATUS,
     PRODSTATUSNAME,
     QTYGOOD, 
     PRODPRIO, 
     PRODLOCKED, 
     PRODTYPE, 
     SCHEDSTATUS, 
     SCHEDDATE, 
     QTYSCHED, 
     QTYSTUP, 
     DLVDATE, 
     STUPDATE, 
     FINISHEDDATE, 
     SCHEDSTART, 
     SCHEDEND, 
     DEFAULTDIMENSION			AS %DEFAULTDIMENSION, 
     HEIGHT, 
     WIDTH, 
     DEPTH, 
     DENSITY, 
     QTYCALC, 
     REALDATE, 
     RESERVATION, 
     PRODPOSTINGTYPE, 
     INVENTTRANSID, 
     INVENTREFTYPE, 
     INVENTREFID, 
     INVENTREFTRANSID, 
     COLLECTREFLEVEL, 
     COLLECTREFPRODID, 
     BOMDATE, 
     BACKORDERSTATUS, 
     PRODPOOLID, 
     PROFITSET, 
     CALCDATE, 
     ROUTEJOBS, 
     CHECKROUTE, 
     PROPERTYID, 
     REMAININVENTPHYSICAL, 
     BOMID, 
     ROUTEID, 
     REQPLANIDSCHED, 
     REQPOID, 
     REFLOOKUP, 
     LATESTSCHEDDIRECTION, 
     LATESTSCHEDDATE, 
     PRODID, 
     INVENTDIMID, 
     SCHEDTOTIME, 
     SCHEDFROMTIME, 
     LATESTSCHEDTIME, 
     DLVTIME, 
     PRODORIGID, 
     GANTTCOLORID, 
     PROJID, 
     PROJPOSTINGTYPE, 
     PROJCATEGORYID, 
     PROJLINEPROPERTYID, 
     PROJTRANSID, 
     PROJCOSTPRICE, 
     PROJCOSTAMOUNT, 
     PROJSALESCURRENCYID, 
     PROJSALESUNITID, 
     PROJSALESPRICE, 
     PROJTAXGROUPID, 
     PROJTAXITEMGROUPID, 
     ACTIVITYNUMBER, 
     PRICEGROUP_RU, 
     CURRENCYCODE_RU, 
     PBAID, 
     PMFTOTALCOSTALLOCATION, 
     PDSCWBATCHEST, 
     PDSCWBATCHSCHED, 
     PDSCWBATCHSIZE, 
     PDSCWBATCHSTUP, 
     PDSCWREMAININVENTPHYSICAL, 
     PMFBULKORD, 
     PMFCOBYVARALLOW, 
     PMFCONSORDID, 
     PMFREWORKBATCH, 
     PMFYIELDPCT, 
     PRODWHSRELEASEPOLICY, 
     RELEASEDDATE, 
     date(floor(CREATEDDATETIME)) as %FECHAKEY, 
     DEL_CREATEDTIME, 
     CREATEDBY, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     AP_QST_MASTERPRODORDID, 
     AP_QST_PROCESSNAME, 
     AP_QST_OPRNUM, 
     AP_QST_MOVJOURNALID, 
     AP_QST_SALESID
Resident OrdenesProduccion_tmp;

UNQUALIFY *;

DROP Table OrdenesProduccion_tmp;
///$tab ProdCalcTrans
QUALIFY *;
UNQUALIFY COLLECTREFPRODID;
ProdCalcTrans:
LOAD 
	COLLECTREFPRODID,
	RESOURCE_,
	COSTGROUPID,
	CALCGROUPID,
	INVENTDIMSTR,
	LINENUM,
	UNITID, 
	OPRID,
	OPRNUM,
	QTY,
	COSTAMOUNT,
	COSTAMOUNT/QTY				as ESTCOSTUNIT,
	SALESAMOUNT,
	CONSUMPVARIABLE,
	CONSUMPCONSTANT, 
	REALCONSUMP,
	REALCOSTAMOUNT,
	REALCOSTADJUSTMENT,
	REALCOSTAMOUNT/REALCONSUMP	AS REALCOSTUNIT

//COLLECTREFPRODID, 
//     COLLECTREFLEVEL, 
//     LINENUM, 
//     CALCTYPE, 
//     IDREFTABLEID, 
//     IDREFRECID, 
//     TRANSREFID, 
//     BOM, 
//     COSTGROUPID, 
//     QTY, 
//     COSTAMOUNT, 
//     COSTMARKUP, 
//     SALESAMOUNT, 
//     SALESMARKUP, 
//     TRANSDATE, 
//     RESOURCE_, 

//     OPRID, 
//     INVENTDIMSTR, 
//     CONSUMPVARIABLE, 

//     REALQTY, 
//     REALCONSUMP, 
//     REALCOSTAMOUNT, 
//     REALCOSTADJUSTMENT, 
//     SALESPRICEMODELUSED, 
//     PRODUCTION, 
//     OPRNUM, 
//     DERIVEDREFERENCE, 
//     DERIVEDREFNUM, 
//     INVENTDIMID, 
//     VENDID, 
//     CONSUMPTYPE, 
//     PRICEDISCQTY, 
//     COSTPRICEMODELUSED, 
//     CALCGROUPID, 
//     TRANSREFTYPE, 
//     FINANCIALINDIRECTAMOUNT_RU, 
//     PMFCOSTALLOCATION, 
//     PMFCOSTALLOCATIONPCT, 
//     PMFOVERHEADAMT, 
//     PMFOVERHEADPCT, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID, 
//     AP_QST_QTYCHARGEACUM
FROM
[..\QVD\ProdCalcTrans.QVD]
(qvd);
UNQUALIFY *;
///$tab InventTransOP
QUALIFY *;
UNQUALIFY PRODID;
InventTransOP:
LOAD 
//	 ITEMID, 
//     INVENTSIZEID, 
//     INVENTCOLORID, 
//     INVENTLOCATIONID, 
//     WMSLOCATIONID, 
//     INVENTSITEID, 
     REFERENCEID as PRODID, 
//     DATEPHYSICAL, 
     DATEFINANCIAL, 
     QTY, 
     COSTAMOUNTPHYSICAL, 
     COSTAMOUNTPOSTED
FROM
[..\QVD\InventTransOP.QVD]
(qvd);

UNQUALIFY *;
///$tab OrdenesCompra
OrdenesCompra_Tmp:
LOAD 
//ENCABEZADO PEDIDO COMPRA
	 PURCHID, 
     ORDERACCOUNT, 
     INVOICEACCOUNT,
     DEFAULTDIMENSION, 
     CREATEDDATETIME, 
     CREATEDBY,

//CAMPOS VARIOS
     DELIVERYDATE, 
     CURRENCYCODE, 
     PAYMENT, 
     CASHDISC, 
     VENDGROUP, 
     LINEDISC, 
     DISCPERCENT, 
     PRICEGROUPID, 
     MULTILINEDISC, 
     ENDDISC, 
     TAXGROUP, 
     DLVTERM, 
     DLVMODE,
     CONTACTPERSONID,
     INVENTSITEID,  
     INVENTLOCATIONID,  

//CAMPOS LLAVES DE ESTADO
	PURCHPOOLID, 
    PURCHSTATUS, 
    DOCUMENTSTATE, 
    DOCUMENTSTATUS, 
    PURCHASETYPE,
    PAYMMODE, 
    PAYMSPEC,
              
//CAMPOS COMENTADOS
//     PURCHNAME, 
//     FREIGHTZONE, 
//     EMAIL, 
//     DELIVERYTYPE, 
//     ADDRESSREFRECID, 
//     ADDRESSREFTABLEID, 
//     INTERCOMPANYORIGINALSALESID, 
//     INTERCOMPANYORIGINALCUSTACCOUNT, 
//     COUNTYORIGDEST, 
//     INTERCOMPANYDIRECTDELIVERY, 
//     INTERCOMPANYCUSTPURCHORDERFORMNUM, 
//     MARKUPGROUP, 
//     URL, 
//     POSTINGPROFILE, 
//     TRANSACTIONCODE, 
//     ENTERPRISENUMBER, 
//     SETTLEVOUCHER, 
//     INTERCOMPANYALLOWINDIRECTCREATION, 
//     INTERCOMPANYORIGIN, 
//     CASHDISCPERCENT, 
//     DELIVERYNAME, 
//     COVSTATUS, 
//     PAYMENTSCHED, 
//     ONETIMEVENDOR, 
//     RETURNITEMNUM, 
//     FREIGHTSLIPTYPE, 
//     BANKCENTRALBANKPURPOSECODE, 
//     ITEMBUYERGROUPID, 
//     PROJID, 
//     VATNUM, 
//     PORT, 
//     INCLTAX, 
//     BANKCENTRALBANKPURPOSETEXT, 
//     NUMBERSEQUENCEGROUP, 
//     LANGUAGEID, 
//     AUTOSUMMARYMODULETYPE, 
//     TRANSPORT, 
//     FIXEDDUEDATE, 
//     STATPROCID, 
//     VENDORREF, 
//     INTERCOMPANYCOMPANYID, 
//     INTERCOMPANYSALESID, 
//     INTERCOMPANYORDER, 
//     RETURNREASONCODEID, 
//     RETURNREPLACEMENTCREATED, 
//     REQATTENTION, 
//     CONFIRMEDDLVEARLIEST, 
//     CONTRACTNUM_SA, 
//     CHANGEREQUESTREQUIRED, 
//     REASONTABLEREF, 
//     ISMODIFIED, 
//     MATCHINGAGREEMENT, 
//     SYSTEMENTRYSOURCE, 
//     SYSTEMENTRYCHANGEPOLICY, 
//     MANUALENTRYCHANGEPOLICY, 
//     VENDINVOICEDECLARATION_IS, 
//     WORKERPURCHPLACER, 
//     DELIVERYPOSTALADDRESS, 
//     BANKDOCUMENTTYPE, 
//     LISTCODE, 
//     ISENCUMBRANCEREQUIRED, 
//     SOURCEDOCUMENTLINE, 
//     SOURCEDOCUMENTHEADER, 
//     REQUESTER, 
//     ACCOUNTINGDISTRIBUTIONTEMPLATE, 
//     ACCOUNTINGDATE, 
//     FINALIZECLOSINGDATE, 
//     CONSTARGET_JP, 
//     INTRASTATFULFILLMENTDATE_HU, 
//     UNITEDVATINVOICE_LT, 
//     INTRASTATADDVALUE_LV, 
//     INVOICEREGISTER_LT, 
//     PACKINGSLIPREGISTER_LT, 
//     SERVICENAME, 
//     SERVICEADDRESS, 
//     ONETIMESUPPLIER, 
//     SERVICEDATE, 
//     CONFIRMEDDLV, 
//     FSHAUTOCREATED, 
//     CROSSDOCKINGDATE, 
//     SERVICECATEGORY, 
//     AVAILSALESDATE, 
//     LOCALDELIVERYDATE, 
//     REPLENISHMENTLOCATION, 
//     RETAILRETAILSTATUSTYPE, 
//     RETAILDRIVERDETAILS, 
//     RETAILCONCESSIONPURCH, 
//     CONFIRMINGPO, 
//     MCRDROPSHIPMENT, 
//     EXCHANGERATEDATE, 
//     FIXEDEXCHRATE, 
//     TAMVENDREBATEGROUPID, 
//     TAXPERIODPAYMENTCODE_PL, 
//     TRANSPORTATIONDOCUMENT, 
//     APPHYSICALPLACEID, 
//     APOBSERVACIONES, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID, 
     APTAXCITY
FROM
[..\QVD\PurchTable.QVD]
(qvd);
Left Join
PurchStatus:
LOAD * INLINE [
    PURCHSTATUS, PURCHSTATUSNAME
    0, 
    1, Pedido Abierto
    2, Recibido
    3, Facturado
    4, Cancelado
];

Left Join
PurchDocumentState:
LOAD * INLINE [
    DOCUMENTSTATE, PURCHDOCUMENTSTATENAME
    0, Borrador
    10, En Revision
    20, Rechazado
    30, Aprobado
    50, Finalizada
    40, Confirmado
];

Left Join
PurchaseType:
LOAD * INLINE [
    PURCHASETYPE, PURCHASETYPENAME
    0, Diario
    1, Presupuesto
    2, Suscripcion
    3, Pedido de Compra
    4, Pedido Devuelto
    5, Acuerdo de Compra y Venta
];


NoConcatenate
OrdenesCompra_tmp2:
LOAD
//ENCABEZADO PEDIDO COMPRA
	 PURCHID, 
     ORDERACCOUNT, 
     INVOICEACCOUNT,
     DEFAULTDIMENSION, 
     CREATEDDATETIME, 
     CREATEDBY,

//CAMPOS VARIOS
     DELIVERYDATE, 
     CURRENCYCODE, 
     PAYMENT, 
     CASHDISC, 
     VENDGROUP, 
     LINEDISC, 
     DISCPERCENT, 
     PRICEGROUPID, 
     MULTILINEDISC, 
     ENDDISC, 
     TAXGROUP, 
     DLVTERM, 
     DLVMODE,
     CONTACTPERSONID,
     INVENTSITEID,  
     INVENTLOCATIONID,  

//CAMPOS LLAVES DE ESTADO
	PURCHPOOLID, 
    PURCHSTATUS, 
    DOCUMENTSTATE, 
    DOCUMENTSTATUS, 
    PURCHASETYPE,
    PAYMMODE, 
    PAYMSPEC,
	PURCHSTATUSNAME,
	PURCHDOCUMENTSTATENAME,
	PURCHASETYPENAME
Resident OrdenesCompra_Tmp;

DROP Table OrdenesCompra_Tmp;


LineasOC_Tmp:
LOAD 
//DATOS LINEA
	PURCHID, 
     ITEMID, 

     SHIPPINGDATEREQUESTED, 
     DELIVERYDATE, 
     NAME, 
     TAXGROUP, 
     QTYORDERED, 
     PURCHRECEIVEDNOW, 
     REMAINPURCHPHYSICAL, 
     REMAINPURCHFINANCIAL, 
     PRICEUNIT, 
     PURCHPRICE, 
     CURRENCYCODE, 
     LINEPERCENT, 
     LINEDISC, 
     LINEAMOUNT, 
     EXTERNALITEMID, 
     PURCHUNIT, 
     CONFIRMEDDLV, 
//     ADDRESSREFRECID, 
     INVENTTRANSID, 
     VENDGROUP, 
     VENDACCOUNT, 
//     ADDRESSREFTABLEID, 
     PURCHQTY, 
     PURCHMARKUP, 
//     INVENTRECEIVEDNOW, 
//     MULTILNDISC, 
//     MULTILNPERCENT,

//CAMPOS LLAVES 
     PURCHSTATUS, 
     PURCHASETYPE, 

//     COVREF, 
     REMAININVENTPHYSICAL, 
//     TAXITEMGROUP, 
//     TRANSACTIONCODE, 
     SHIPPINGDATECONFIRMED, 
//     COUNTYORIGDEST, 
//     TAXAUTOGENERATED, 
//     UNDERDELIVERYPCT, 
//     OVERDELIVERYPCT, 
//     TAX1099AMOUNT, 
//     BARCODE, 
//     BARCODETYPE, 
//     INVENTREFID, 
//     INVENTREFTRANSID, 
//     ITEMREFTYPE, 
//     PROJTRANSID, 
     BLOCKED, 
     COMPLETE, 
//     REQPLANIDSCHED, 
//     REQPOID, 
//     ITEMROUTEID, 
//     ITEMBOMID, 
//     LINEHEADER, 
//     SCRAP, 
//     RETURNACTIONID, 
//     INTERCOMPANYORIGIN, 
//     PROJCATEGORYID, 
//     PROJID, 
     INVENTDIMID, 
//     TRANSPORT, 
//     STATPROCID, 
//     PORT, 
//     ASSETID, 
//     ASSETTRANSTYPEPURCH, 
//     ASSETBOOKID, 
//     PROJLINEPROPERTYID, 
//     PROJTAXITEMGROUPID, 
//     PROJTAXGROUPID, 
//     PROJSALESPRICE, 
//     PROJSALESCURRENCYID, 
//     INTERCOMPANYINVENTTRANSID, 
//     PROJSALESUNITID, 
//     DELIVERYNAME, 
//     DELIVERYTYPE, 
//     CUSTOMERREF, 
//     CUSTPURCHASEORDERFORMNUM, 
//     STATTRIANGULARDEAL, 
//     TAX1099STATE, 
//     TAX1099STATEAMOUNT, 
//     ITEMTAGGING, 
//     CASETAGGING, 
//     PALLETTAGGING, 
     REMAININVENTFINANCIAL, 
//     PURCHREQLINEREFID, 
//     DEPRECIATIONSTARTDATE, 
//     ACTIVITYNUMBER, 
//     RETURNSTATUS, 
//     RETURNDISPOSITIONCODEID, 
//     CREATEFIXEDASSET, 
     ASSETGROUP, 
//     REQATTENTION, 
//     PURCHREQID, 
//     TAX1099RECID, 
//     MATCHINGPOLICY, 
//     PROCUREMENTCATEGORY, 
//     LINEDELIVERYTYPE, 
//     SOURCEDOCUMENTLINE, 
     DEFAULTDIMENSION, 
     LEDGERDIMENSION, 
//     ISDELETED, 
//     ISMODIFIED, 
//     MATCHINGAGREEMENTLINE, 
//     MANUALENTRYCHANGEPOLICY, 
//     SYSTEMENTRYCHANGEPOLICY, 
//     SYSTEMENTRYSOURCE, 
     WORKFLOWSTATE, 
//     EDITABLEINWORKFLOW, 
//     WFINVRECEIVEDSTATE, 
//     WFDELIVERYDUESTATE, 
//     TAX1099FIELDS, 
//     GSTHSTTAXTYPE_CA, 
//     DELIVERYPOSTALADDRESS, 
     LINENUMBER, 
//     TAXWITHHOLDITEMGROUPHEADING_TH, 
//     REQUESTER, 
//     ACCOUNTINGDISTRIBUTIONTEMPLATE, 
//     OPERATIONTYPE_MX, 
//     STOCKEDPRODUCT, 
//     ISFINALIZED, 
//     PLANREFERENCE, 
//     ISINVOICEMATCHED, 
//     ITEMPBAID, 
//     TAXWITHHOLDBASECUR_TH, 
//     TAXWITHHOLDGROUP_TH, 
//     TAXSERVICECODE_BR, 
//     INTRASTATFULFILLMENTDATE_HU, 
//     CFOPTABLE_BR, 
//     STATISTICVALUE_LT, 
//     PSARETAINSCHEDULEID, 
//     PSATOTALRETAINAMOUNT, 
//     SERVICEDATE, 
//     REMAINDER, 
//     SERVICEADDRESS, 
//     INVENTINVOICENOW, 
//     RETAILLINENUMEX1, 
//     VARIANTID, 
//     RETAILPACKAGEID, 
//     RBOPACKAGELINENUM, 
//     RETAILTEMPVALUEEX2, 
//     MCRDROPSHIPMENT, 
//     MCRDROPSHIPCOMMENT, 
//     MCRDROPSHIPSTATUS, 
//     AGREEMENTSKIPAUTOLINK, 
//     CONFIRMEDTAXAMOUNT, 
//     CONFIRMEDTAXWRITECODE, 
     DISCAMOUNT, 
     DISCPERCENT, 
//     ISPWP, 
//     MANUALMODIFIEDFIELD, 
//     MCRORDERLINE2PRICEHISTORYREF, 
//     PDSCALCULATIONID, 
//     PDSCWINVENTRECEIVEDNOW, 
//     PDSCWQTY, 
//     PDSCWREMAININVENTFINANCIAL, 
//     PDSCWREMAININVENTPHYSICAL, 
//     PROJWORKER, 
//     PURCHCOMMITMENTLINE_PSN, 
//     SKIPDISTRIBUTIONUPDATE, 
//     TAMITEMVENDREBATEGROUPID, 
//     APFIXEDASSETTYPE, 
//     APISTAXWITHHOLD, 
//     BUDGETRESERVATIONLINE_PSN, 
//     CREDITEDVENDINVOICETRANS, 
//     MODIFIEDDATETIME, 
     CREATEDDATETIME//, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID, 
//     PACKEDWHSLINE
FROM
[..\QVD\PurchLine.QVD]
(qvd);
Left Join (LineasOC_Tmp)
LOAD 
	 INVENTDIMID, 
     INVENTSIZEID, 
     INVENTCOLORID
FROM
[..\QVD\InventDim.QVD]
(qvd);



QUALIFY *;
UNQUALIFY PURCHID;
Left Join(OrdenesCompra_tmp2)
//NoConcatenate
LineasOC:
LOAD
	 PURCHID, 
     ITEMID, 
     SHIPPINGDATEREQUESTED, 
     DELIVERYDATE, 
     NAME, 
     TAXGROUP, 
     QTYORDERED, 
     PURCHRECEIVEDNOW, 
     REMAINPURCHPHYSICAL, 
     REMAINPURCHFINANCIAL, 
     PRICEUNIT, 
     PURCHPRICE, 
     CURRENCYCODE, 
     LINEPERCENT,
     LINEDISC, 
     LINEAMOUNT, 
     EXTERNALITEMID, 
     PURCHUNIT, 
     CONFIRMEDDLV, 
     INVENTTRANSID, 
     VENDGROUP, 
     VENDACCOUNT, 
     PURCHQTY, 
     PURCHMARKUP, 
     PURCHSTATUS, 
     PURCHASETYPE, 
     REMAININVENTPHYSICAL, 
     SHIPPINGDATECONFIRMED, 
     BLOCKED, 
     COMPLETE, 
     INVENTDIMID, 
     REMAININVENTFINANCIAL, 
     ASSETGROUP, 
     DEFAULTDIMENSION, 
     LEDGERDIMENSION, 
     WORKFLOWSTATE, 
     LINENUMBER, 
     DISCAMOUNT, 
     DISCPERCENT, 
     CREATEDDATETIME,
     INVENTSIZEID, 
     INVENTCOLORID
Resident LineasOC_Tmp;

UNQUALIFY *;

DROP Table LineasOC_Tmp;

QUALIFY *;
UNQUALIFY  %OrdenesCompraKey,%DEFAULTDIMENSION,VENPACKINGLIPID,%KEYPRODUCT,%OrdenesCompraKey,%FECHAKEY;
NoConcatenate
OrdenesCompra:
LOAD
	 AutoNumber(RecNo())		as %OrdenesCompraKey,
	 PURCHID, 
     ORDERACCOUNT, 
     INVOICEACCOUNT,
     DEFAULTDIMENSION AS DEFAULTDIMENSION_OC, 
     date(floor(CREATEDDATETIME)) as %FECHAKEY,
     CREATEDBY,

//CAMPOS VARIOS
     DELIVERYDATE, 
     CURRENCYCODE, 
     PAYMENT, 
     CASHDISC, 
     VENDGROUP, 
     LINEDISC, 
     DISCPERCENT, 
     PRICEGROUPID, 
     MULTILINEDISC, 
     ENDDISC, 
     TAXGROUP, 
     DLVTERM, 
     DLVMODE,
     CONTACTPERSONID,
     INVENTSITEID,  
     INVENTLOCATIONID,  

//CAMPOS LLAVES DE ESTADO
	PURCHPOOLID, 
    PURCHSTATUS, 
    DOCUMENTSTATE, 
    DOCUMENTSTATUS, 
    PURCHASETYPE,
    PAYMMODE, 
    PAYMSPEC,
	PURCHSTATUSNAME,
	PURCHDOCUMENTSTATENAME,
	PURCHASETYPENAME,
	PURCHID&LineasOC.INVENTTRANSID AS VENPACKINGLIPID,
     LineasOC.ITEMID, 
     LineasOC.SHIPPINGDATEREQUESTED, 
     LineasOC.DELIVERYDATE, 
     LineasOC.NAME, 
     LineasOC.TAXGROUP, 
     LineasOC.QTYORDERED, 
     LineasOC.PURCHRECEIVEDNOW, 
     LineasOC.REMAINPURCHPHYSICAL, 
     LineasOC.REMAINPURCHFINANCIAL, 
     LineasOC.PRICEUNIT, 
     LineasOC.PURCHPRICE, 
     LineasOC.CURRENCYCODE, 
     LineasOC.LINEPERCENT, 
     LineasOC.LINEDISC, 
     LineasOC.LINEAMOUNT, 
     LineasOC.EXTERNALITEMID, 
     LineasOC.PURCHUNIT, 
     LineasOC.CONFIRMEDDLV, 
     LineasOC.INVENTTRANSID, 
     LineasOC.VENDGROUP, 
     LineasOC.VENDACCOUNT, 
     LineasOC.PURCHQTY, 
     LineasOC.PURCHMARKUP, 
     LineasOC.PURCHSTATUS, 
     LineasOC.PURCHASETYPE, 
     LineasOC.REMAININVENTPHYSICAL, 
     LineasOC.SHIPPINGDATECONFIRMED, 
     LineasOC.BLOCKED, 
     LineasOC.COMPLETE, 
     LineasOC.INVENTDIMID, 
     LineasOC.REMAININVENTFINANCIAL, 
     LineasOC.ASSETGROUP, 
     LineasOC.DEFAULTDIMENSION AS %DEFAULTDIMENSION, 
     LineasOC.LEDGERDIMENSION, 
     LineasOC.WORKFLOWSTATE,
      LineasOC.ITEMID&LineasOC.INVENTSIZEID&LineasOC.INVENTCOLORID as %KEYPRODUCT, 
     LineasOC.LINENUMBER, 
     LineasOC.DISCAMOUNT, 
     LineasOC.DISCPERCENT, 
     LineasOC.CREATEDDATETIME,
     LineasOC.INVENTSIZEID, 
     LineasOC.INVENTCOLORID
Resident OrdenesCompra_tmp2;

DROP Table OrdenesCompra_tmp2;

UNQUALIFY *;
///$tab LinkTable
LinkTable:
	LOAD %OrdenesCompraKey,
		 %DEFAULTDIMENSION 													AS SK.DEFAULTDIMENSION,
		 %KEYPRODUCT														AS SK.KEYPRODUCT,
		 %FECHAKEY															AS SK.FECHA
	Resident OrdenesCompra;
Concatenate(LinkTable)
	LOAD 
		 %OrdenesProduccionKey,
		 %DEFAULTDIMENSION 													AS SK.DEFAULTDIMENSION,
		 %KEYPRODUCT														AS SK.KEYPRODUCT,
		 %FECHAKEY															AS SK.FECHA
	Resident OrdenesProduccion;
	
DROP Fields %DEFAULTDIMENSION,%FECHAKEY,%KEYPRODUCT; 
///$tab DefaulDimensions
QUALIFY *;
UNQUALIFY SK.DEFAULTDIMENSION;
DefaultDimensions:
LOAD DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     DEFAULTDIMENSION AS SK.DEFAULTDIMENSION, 
     DIMENSION_CENTRO_DE_COSTO, 
     DIMENSION_COLECCION, 
     DIMENSION_ESTRUCTURA_COMERCIAL, 
     DIMENSION_FLUJO_DE_EFECTIVO, 
     DIMENSION_LINEA, 
     DIMENSION_MAINACCOUNT, 
     DIMENSION_MARCA, 
     DIMENSION_PROYECTO, 
     DIMENSION_SUBLINEA, 
     DIMENSION_TERCERO, 
     DIMENSION_TIPO_DE_TIENDA, 
     DESC_CENTRO_DE_COSTO, 
     DESC_COLECCION, 
     DESC_ESTRUCTURA_COMERCIAL, 
     DESC_FLUJO_DE_EFECTIVO, 
     DESC_LINEA, 
     DESC_MAINACCOUNT, 
     DESC_MARCA, 
     DESC_PROYECTO, 
     DESC_SUBLINEA, 
     DESC_TERCERO, 
     DESC_TIPO_DE_TIENDA, 
     MODIFIEDDATETIME, 
     CREATEDDATETIME
FROM
[..\QVD\DefaulDimensions.QVD]
(qvd);

UNQUALIFY *;
///$tab VendPackingLip
VendPackingLip_tmp:
LOAD 
	  PURCHID, 
//     ORDERACCOUNT, 
//     INVOICEACCOUNT, 
     PACKINGSLIPID, 
//     INTERCOMPANYPOSTED, 
     DELIVERYDATE, 
//     DELIVERYNAME, 
//     DELIVERYPOSTALADDRESS, 
//     COUNTRYREGIONID, 
//     INTRASTATDISPATCH, 
//     DLVTERM, 
//     DLVMODE, 
//     DELIVERYTYPE, 
//     PURCHASETYPE, 
//     RETURNITEMNUM, 
//     FREIGHTSLIPNUM, 
//     FREIGHTSLIPTYPE, 
//     ITEMBUYERGROUPID, 
//     REQATTENTION, 
//     NUMBERSEQUENCEGROUP, 
//     INTERCOMPANYCOMPANYID, 
//     INTERCOMPANYSALESID, 
//     LANGUAGEID, 
//     DOCUMENTDATE, 
////     DEFAULTDIMENSION, 
//     SOURCEDOCUMENTHEADER, 
//     REQUESTER, 
//     RECEIPTLISTDEVIATIONTYPE_RU, 
//     GRNNUMBER_IN, 
//     INVENTPROFILETYPE_RU, 
////     INTRASTATFULFILLMENTDATE_HU, 
//     OFFSESSIONID_RU, 
//     CURRENCYCODE_W, 
//     ORDERBALANCE_RU, 
//     ENDDISC_RU, 
//     CONSIGNEEACCOUNT_RU, 
//     CONSIGNORACCOUNT_RU, 
//     PACKINGSLIPSTATUS_LT, 
//     PACKINGSLIPNUMBERINGCODE_LT, 
//     PACKINGSLIPREGISTER_LT, 
//     INVOICEISSUEDUEDATE_W, 
//     APCONTAINERID, 
//     APEXPORTREASON, 
//     APINVOICEELECTRONIC, 
//     APINVOICEELECTRONICDATE, 
//     APINVOICEEXPORT, 
//     APINVOICEEXPORTDATE, 
//     APISSUEEXCEP, 
//     APISSUESTAMP, 
//     APNOTEINVOICEELECTRONIC, 
//     APNOTEINVOICEEXPORT, 
//     APNOTEORDERNOTE, 
//     APNOTEPACKINGSLIP, 
//     APNOTEPURCHASEORDER, 
//     APORDERNOTE, 
//     APORDERNOTEDATE, 
//     APORDERTYPE, 
//     APPACKINGSLIP, 
//     APPACKINGSLIPDATE, 
//     APPURCHASEORDER, 
//     APPURCHASEORDERDATE, 
//     APPUTMERCHANDISE, 
//     APSALESMODALITY, 
//     APSERVICEINDICATOR, 
//     APSETTLETYPE, 
//     APSHIPMENTID, 
//     APSTAMP, 
//     APTRANSFERTYPE, 
//     APTRANSPORTADDRESS, 
//     APTRANSPORTCITY, 
//     APTRANSPORTCOUNTRY, 
//     APTRANSPORTCOUNTY, 
//     APTRANSPORTDATA, 
//     APTRANSPORTFREIGHT, 
//     APTRANSPORTSTATE, 
//     APTRANSPORTSURE, 
//     APADDRESSCODE, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
     RECID				as VENDPACKINGSLIPJOUR
FROM
[..\QVD\VendPackingSlipJour.QVD]
(qvd);
left Join (VendPackingLip_tmp)
LOAD 
////	PACKINGSLIPID, 
////  DELIVERYDATE, 
     LINENUM, 
     INVENTTRANSID, 
//     DESTCOUNTRYREGIONID, 
     ITEMID, 
//     EXTERNALITEMID, 
//     NAME, 
     ORDERED, 
     QTY, 
     REMAIN, 
     PRICEUNIT, 
     VALUEMST, 
//     INVENTREFID, 
//     INVENTREFTYPE, 
//     PURCHUNIT, 
//     TRANSACTIONCODE, 
//     INVENTREFTRANSID, 
//     INTERCOMPANYINVENTTRANSID, 
//     DESTSTATE, 
//     REMAININVENT, 
//     ORIGPURCHID, 
//     RETURNACTIONID, 
//     TRANSPORT, 
     INVENTDIMID, 
//     STATPROCID, 
//     PORT, 
//     INVENTDATE, 
////     NUMBERSEQUENCEGROUP, 
//     DESTCOUNTY, 
//     INTRASTATDISPATCHID, 
//     INVENTQTY, 
//     REASONTABLEREF, 
//     PROCUREMENTCATEGORY, 
//     ITEMCODEID, 
//     ORIGSTATEID, 
//     ORIGCOUNTRYREGIONID, 
//     WEIGHT, 
//     DEFAULTDIMENSION, 
//     SOURCEDOCUMENTLINE, 
//     WORKERPURCHASER, 
//     PURCHASELINEEXPECTEDDELIVERYDATE, 
//     PURCHASELINELINENUMBER, 
     VENDPACKINGSLIPJOUR 
//     FULLYMATCHED, 
//     COSTLEDGERVOUCHER, 
//     ACCOUNTINGDATE, 
//     STOCKEDPRODUCT, 
//     NGPCODESTABLE_FR, 
//     RECEIVEDQTY_IN, 
//     REJECTEDQTY_IN, 
//     ACCEPTEDQTY_IN, 
//     INVOICETRANSREFRECID, 
//     INTRASTATFULFILLMENTDATE_HU, 
////     CURRENCYCODE_W, 
//     DEVIATIONQTY_RU, 
//     EXCISEVALUE_RU, 
//     VATVALUE_RU, 
//     EXCISEAMOUNT_RU, 
//     VATAMOUNT_RU, 
//     LINEAMOUNT_W, 
//     TAXAMOUNT_RU, 
//     TAXITEMGROUP_RU, 
//     TAXGROUP_RU, 
//     STATISTICVALUE_LT, 
//     PDSCWORDERED, 
//     PDSCWQTY, 
//     PDSCWREMAIN//, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID
FROM
[..\QVD\VendPackingSlipTrans.QVD]
(qvd);
left Join (VendPackingLip_tmp)
LOAD 
	 INVENTDIMID, 
     INVENTSIZEID, 
     INVENTCOLORID
FROM
[..\QVD\InventDim.QVD]
(qvd);

QUALIFY*;
UNQUALIFY VENPACKINGLIPID;
NoConcatenate
RecepcionesOP:
LOAD
	 PURCHID, 
     PACKINGSLIPID, 
     DELIVERYDATE,  
     LINENUM, 
     INVENTTRANSID,
     PURCHID&INVENTTRANSID AS VENPACKINGLIPID,
     ITEMID, 
     ORDERED, 
     QTY, 
     REMAIN, 
     PRICEUNIT, 
     VALUEMST,  
     VENDPACKINGSLIPJOUR,
	 INVENTDIMID, 
     INVENTSIZEID, 
     INVENTCOLORID
Resident VendPackingLip_tmp;

UNQUALIFY *;

DROP Table VendPackingLip_tmp;
///$tab MasterProduct
QUALIFY *;
UNQUALIFY CATEGORYRECID;
Productos:
LOAD 
	 CODARTICULO&TALLA&COLOR as SK.KEYPRODUCT,
	 NUMEROPRODUCTODISPLAY, 
     NOMBREBUSQUEDA, 
     TIPOPRODUCTO, 
     NOMBRETIPOPRODUCTO, 
     PRODUCTRECID, 
     CATEGORYRECID, 
     CATEGORYHIERARCHYRECID, 
     CODARTICULO, 
     NOMBREPRODUCTO, 
     NOMBRECATEGORIA, 
     DESCGRUPODIMPRODUCTO, 
     PRODUCTDIMENSIONGROUPRECID, 
     INVENTTABLERECID, 
     DEFAULTDIMENSION, 
     NOMBREGRUPODIMPRODUCTO, 
     NOMBREGRUPODIMALMAC, 
     DESCGRUPODIMALMAC, 
     STORAGEDIMENSIONGROUPRECID, 
     NOMBREGRUPODIMSEGUIMIENTO, 
     DESCGRUPODIMSEGUIMIENTO, 
     PRODUCTINVENTDIMID, 
     EMPRESA, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     EMITIDO, 
     NOMBREEMITIDO, 
     SUBTIPOPRODUCTO, 
     NOMBRESUBTIPOPRODUCTO, 
     NOMBREJERARQUIACATEGORIA, 
     NUMEROPRODUCTO, 
     UBICACION, 
     SERIAL, 
     ALMACEN, 
     CODIGOBARRAS, 
     NUMEROVARIANTE, 
     COLOR, 
     ESTILO, 
     SITIO, 
     TALLA, 
     TRACKINGDIMENSIONGROUPRECID, 
     PRODUCTPARENT
FROM
[..\QVD\QST_MaestroProductos.QVD]
(qvd);

MasterProductAttributes:
LOAD
//LOAD AT_APARIENCIA_DETALLADA, 
//     AT_APARIENCIA_GENERAL, 
//     AT_BANDA_DE_PRECIO, 
//     AT_CLASIFICACION_INVENTARIO, 
//     AT_CLIMA, 
//     AT_COLECCION, 
//     AT_CUELLO, 
//     AT_DISENADOR, 
//     AT_GENERO, 
//     AT_GENERO_MATERIAL, 
//     AT_GRUPO_DE_PRODUCTOS, 
//     AT_LAVADO, 
//     AT_LINEA_MATERIAL, 
//     AT_MANGA, 
//     AT_MATERIAL_INSUMO, 
//     AT_NIVEL_DE_MODA, 
//     AT_OPERACION_USO, 
//     AT_PATRONISTA, 
//     AT_SILUETA, 
//     AT_TIPO_DE_ADQUISICION, 
//     AT_TIPO_DE_PRENDA, 
//     AT_TIPO_DE_PRODUCTO, 
//     AT_TIPOLOGIA_DE_TEJIDO, 
     ATVAL_APARIENCIA_DETALLADA, 
     ATVAL_APARIENCIA_GENERAL, 
     ATVAL_BANDA_DE_PRECIO, 
     ATVAL_CLASIFICACION_INVENTARIO, 
     ATVAL_CLIMA, 
     ATVAL_COLECCION, 
     ATVAL_CUELLO, 
     ATVAL_DISENADOR, 
     ATVAL_GENERO, 
     ATVAL_GENERO_MATERIAL, 
     ATVAL_GRUPO_DE_PRODUCTOS, 
     ATVAL_LAVADO, 
     ATVAL_LINEA_MATERIAL, 
     ATVAL_MANGA, 
     ATVAL_MATERIAL_INSUMO, 
     ATVAL_NIVEL_DE_MODA, 
     ATVAL_OPERACION_USO, 
     ATVAL_PATRONISTA, 
     ATVAL_SILUETA, 
     ATVAL_TIPO_DE_ADQUISICION, 
     ATVAL_TIPO_DE_PRENDA, 
     ATVAL_TIPO_DE_PRODUCTO, 
     ATVAL_TIPOLOGIA_DE_TEJIDO, 
     NOMBRECATEGORIA as NC, 
     CATEGORYRECID//, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID
FROM
[..\QVD\QST_MaestroProductosAtributes.QVD]
(qvd);


///$tab AP_QST_Prod
QUALIFY *;
AP_QST_ProdReport:
LOAD AP_QST_MASTERPRODORDID, 
     CALCDATE, 
     DIMBRAND, 
     DIMCOLLECTION, 
     DIMLINE, 
     DIMSUBLINE, 
     DLVDATE, 
     FINISHEDDATE, 
     GARMENTTYPE, 
     ITEMCREATEDATE, 
     ITEMID, 
     PRODID, 
     PRODORDERCREATEDATE, 
     PRODPOOLID, 
     QTYCALC, 
     QTYSTUP, 
     REALDATE, 
     RELEASEDDATE, 
     ROUTEDATEDIFF1, 
     ROUTEDATEDIFF2, 
     ROUTEDATEDIFF3, 
     ROUTEDATEDIFF4, 
     ROUTEDATEDIFF5, 
     ROUTEDATEDIFF6, 
     ROUTEDATEDIFF7, 
     ROUTEDATEDIFF8, 
     ROUTEESTIMATEDDATE1, 
     ROUTEESTIMATEDDATE2, 
     ROUTEESTIMATEDDATE3, 
     ROUTEESTIMATEDDATE4, 
     ROUTEESTIMATEDDATE5, 
     ROUTEESTIMATEDDATE6, 
     ROUTEESTIMATEDDATE7, 
     ROUTEESTIMATEDDATE8, 
     ROUTEQTYGOOD1, 
     ROUTEQTYGOOD2, 
     ROUTEQTYGOOD3, 
     ROUTEQTYGOOD4, 
     ROUTEQTYGOOD5, 
     ROUTEQTYGOOD6, 
     ROUTEQTYGOOD7, 
     ROUTEQTYGOOD8, 
     ROUTEREALDATE1, 
     ROUTEREALDATE2, 
     ROUTEREALDATE3, 
     ROUTEREALDATE4, 
     ROUTEREALDATE5, 
     ROUTEREALDATE6, 
     ROUTEREALDATE7, 
     ROUTEREALDATE8, 
     ROUTEWRKCTRID1, 
     ROUTEWRKCTRID2, 
     ROUTEWRKCTRID3, 
     ROUTEWRKCTRID4, 
     ROUTEWRKCTRID5, 
     ROUTEWRKCTRID6, 
     ROUTEWRKCTRID7, 
     ROUTEWRKCTRID8, 
     SCHEDDATE, 
     SCHEDEND, 
     OPRNAME1, 
     OPRNAME2, 
     OPRNAME3, 
     OPRNAME4, 
     OPRNAME5, 
     OPRNAME6, 
     OPRNAME7, 
     OPRNAME8, 
     PRODSTATUS, 
     BRAND, 
     LINE, 
     SUBLINE, 
     COLLECTION, 
     ROUTEINILDATE1, 
     ROUTEINIDATE2, 
     ROUTEINIDATE3, 
     ROUTEINIDATE4, 
     ROUTEINIDATE5, 
     ROUTEINIDATE6, 
     ROUTEINIDATE7, 
     ROUTEINIDATE8, 
     INVENTDIMID, 
     QTYCHARGE1, 
     QTYCHARGE2, 
     QTYCHARGE3, 
     QTYCHARGE4, 
     QTYCHARGE5, 
     QTYCHARGE6, 
     QTYCHARGE7, 
     QTYCHARGE8, 
     WORKERAUDIT, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID
FROM
[..\QVD\AP_QST_ProdReport.QVD]
(qvd);

///$tab Exit
EXIT SCRIPT;
///$tab BaseEnums


PurchStatus:
LOAD * INLINE [
    PURCHSTATUS, PURCHSTATUSNAME
    0, 
    1, Pedido Abierto
    2, Recibido
    3, Facturado
    4, Cancelado
];

PurchDocumentState:
LOAD * INLINE [
    DOCUMENTSTATE, PURCHDOCUMENTSTATENAME
    0, Borrador
    10, En Revision
    20, Rechazado
    30, Aprobado
    50, Finalizada
    40, Confirmado
];

PurchaseType:
LOAD * INLINE [
    PURCHASETYPE, PURCHASETYPENAME
    0, Diario
    1, Presupuesto
    2, Suscripcion
    3, Pedido de Compra
    4, Pedido Devuelto
    5, Acuerdo de Compra y Venta
];

///$tab MaestrodeProductos
Productos:
LOAD PRODUCT_RECID, 
     PRODUCT_CODE,
     PRODUCT_COLORID, 
     PRODUCT_SIZEID, 
//     PRODUCT_CODE&PRODUCT_SIZEID&PRODUCT_COLORID as KEYPRODUCT2, 
     PRODUCT_NAME, 
     PRODUCT_TYPE, 
     PRODUCT_HIERARCHY, 
     PRODUCT_CATEGORY, 
     PRODUCT_DIMPRODGROUPNAME, 
     PRODUCT_DIMPRODGROUPDESC, 
     PRODUCT_DIMSTORAGEGROUPNAME, 
     PRODUCT_DIMSTORAGEGROUPDESC, 
     PRODUCT_DIMTRACKINGGROUPNAME, 
     PRODUCT_DIMTRACKINGGROUPDESC, 
     PRODUCT_DEFAULTDIMENSION, 
     PRODUCT_INVENTDIMID, 
     PRODUCT_RETAILVARIANTID,     
     PRODUCT_BARCODETYPE, 
     PRODUCT_BARCODE, 
     PRODUCT_UNITID, 
     PRODUCT_LOCATIONID, 
     PRODUCT_SERIALID, 
     PRODUCT_SITEID, 
     PRODUCT_STATUSID, 
     PRODUCT_STYLEID, 
     PRODUCT_WMSLOCATIONID, 
     PRODUCT_WMSPALLETID
FROM
[..\QVD\ProductMaster.QVD]
(qvd);
///$tab BOMCalcTrans
QUALIFY *;
BOMCalcTrans:
LOAD BOMID, 
     PRICECALCID, 
     ITEMID, 
     INVENTSIZEID, 
     INVENTCOLORID, 
     COSTPRICE_CAB, 
     COSTMARKUP_CAB, 
     SALESPRICE_CAB, 
     SALESMARKUP_CAB, 
     QTY_CAB, 
     TRANSDATE, 
     CALCGROUPID, 
     RESOURCE_, 
     LEVEL_, 
     COSTGROUPID, 
     OPRID, 
     CONSUMPTIONVARIABLE, 
     UNITID, 
     COSTPRICE, 
     SALESPRICE, 
     QTY, 
     COSTPRICEQTY, 
     SALESPRICEQTY, 
     LINENUM, 
     OPRNUM, 
     COSTPRICEUNIT, 
     COSTMARKUPQTY, 
     SALESMARKUPQTY, 
     INVENTDIMID, 
     ROUTEID
FROM
[..\QVD\BOMCalcTrans.QVD]
(qvd);

UNQUALIFY *;
