///$tab Main
SET ThousandSep='.';
SET DecimalSep=',';
SET MoneyThousandSep='.';
SET MoneyDecimalSep=',';
SET MoneyFormat='$#.##0,00;-$#.##0,00';
SET TimeFormat='h:mm:ss TT';
SET DateFormat='DD/MM/YYYY';
SET TimestampFormat='DD/MM/YYYY h:mm:ss[.fff] TT';
SET MonthNames='ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sep.;oct.;nov.;dic.';
SET DayNames='lun.;mar.;mié.;jue.;vie.;sáb.;dom.';
SET LongMonthNames='enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiembre;octubre;noviembre;diciembre';
SET LongDayNames='lunes;martes;miércoles;jueves;viernes;sábado;domingo';
SET FirstWeekDay=0;
SET BrokenWeeks=1;
SET ReferenceDay=0;
SET FirstMonthOfYear=1;
SET CollationLocale='es-CO';

///$tab Calendario
QUALIFY *;
UNQUALIFY SK.FECHA;
Calendario:
LOAD num(Fecha)				AS SK.FECHA,
//	 num(Fecha)				AS SK.FECHA1,
     Año					AS ano, 
     Mes					as nomMes, 
     MonthYear, 
     %_Fechakey, 
     NumericMonthYear, 
     NumericMonth, 
     Semestre, 
     Trimestre				as nomTrim,
     trimestre, 
     Week					as semana,
     SemanaMes, 
     Weekday				as nombreDia, 
     Dia					as dia, 
     DateMMDD,
     CYTD,
     FPYTD,
     Festivo, 
     EsFestivo
FROM
[..\QVD\Calendario_Final.QVD]
(qvd)
WHERE Fecha >= '01/01/2016';

UNQUALIFY *;
///$tab Clientes
MaestroClientes:
LOAD ACCOUNTNUM  as IDCLIENTE,  
     DIGIT, 
     IDENTIFICATIONTYPE, 
     NOMBREIDENTIFICATIONTYPE, 
     IDENTIFICATIONNUM, 
     CUSTGROUPID, 
     CREDITMAX, 
     CURRENCY, 
     NAME, 
     FIRSTNAME, 
     MIDDLENAME, 
     LASTNAME, 
     SECONDLASTNAME, 
     DIRPARTYTYPE, 
     NOMBREDIRPARTYTYPE, 
     MAINEMAIL, 
     MAINPHONE, 
     MAINURL, 
     PAYMTERMID, 
     COUNTRYID, 
     COUNTRYVALUE, 
     STATEID, 
     STATEVALUE, 
     CITYID, 
     CITYVALUE, 
     CUSTGROUPVALUE, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     ADDRESSING, 
     PAYMTERMVALUE, 
     PAYMMODEID, 
     PAYMMODEVALUE, 
     MANDATORYCREDITLIMIT, 
     NOMBREMANDATORYCREDITLIMIT, 
     DIMENSIONDEFAULT, 
     IDVENDEDOR, 
     NOMBREVENDEDOR,
     SALESDISTRICT
FROM
[..\QVD\QST_MaestroClientes.QVD]
(qvd);

///$tab Pedidos
PedidosVenta:
LOAD IDPEDIDO,
	 CODARTICULO&TALLA&COLOR as SK.KEYPRODUCT, 
     IDCLIENTE, 
     NOMBRECLIENTE, 
     DEFAULTDIMENSIONPEDIDO, 
     ESTADOPEDIDO, 
     TIPOPEDIDO,
     NOMBRETIPOPEDIDO, 
     NOMBREESTADOPEDIDO, 
     CONDICIONPAGO, 
     FECHACREACIONPEDIDO, 
     date(floor(FECHACREACIONPEDIDO)) as SK.FECHA,
     FECHACREACIONPEDIDOTZID,
     PENDIENTEENTREGA, 
     PEDIDOCREADOPOR, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID, 
     GRUPOCOMISION, 
     CODARTICULO, 
     NUMEROLINEA, 
     NOMBREARTICULO, 
     PRECIOUNITARIO, 
     CANTIDAD, 
     ESTADOLINEA, 
     NOMBREESTADOLINEA, 
     VALORNETO, 
     DESCUENTO, 
     NUMEROVARIANTE, 
     TALLA, 
     COLOR, 
     ESTILO, 
     SITIO, 
     ALMACEN, 
     DEFAULTDIMENSIONLINEA as SK.DEFAULTDIMENSION, 
     RECIDLINE, 
     UNIDADMEDIDA, 
//     IDVENDEDOR, 
//     NOMBREVENDEDOR,
	 RAZONDEVOLUCION,
	 RAZONGRUPO,
	 TAXGROUP,
	 TAXGROUPNAME,
     GRUPOVENTAS,
     PORCENTAJE
FROM
[..\QVD\Salesline.QVD]
(qvd);

///$tab Ventas
Ventas:
LOAD ASIENTOFACTURA, 
//     CONDICIONPAGO, 
     CUENTACLIENTE, 
     DIASVENCIDOS, 
     DIMENSIONDEFAULTFACTSERV, 
     DIMENSIONDEFAULTSALES, 
     DIVISA, 
     ESTADOFACTURA,
     NOMBREESTADOFACTURA, 
     FECHACIERRE, 
     FECHAFACTURA, 
     FECHAVENCIMIENTO, 
     IDFACTURA, 
     MODULOGENERACION,
     NOMBREMODULOGENERACION, 
//     NOMBRECLIENTE, 
     SALDOCORRIENTETOTAL, 
     SALDOTOTAL, 
     SALDOTOTALDIVISA, 
     SALDOVENCIDOTOTAL, 
     SALESID			as IDPEDIDO, 
     ULTIMAFECHALIQUIDACION, 
     ULTIMOASIENTOLIQUIDACION, 
     VALORDIVISALIQUIDADA, 
     VALORFACTURA, 
     VALORFACTURADIVISATRANS, 
     VALORLIQUIDADO, 
     VENCIDA,
     NOMBREVENCIDA, 
     CREATEDDATETIME, 
     CREATEDBY,
	CANTIDAD as CantidadVentas
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID
FROM
[..\QVD\CustInvoiceTrans.QVD]
(qvd);

///$tab MaestroProductos
QUALIFY *;
UNQUALIFY SK.KEYPRODUCT,CATEGORYRECID;
Productos:
LOAD 
	 CODARTICULO&TALLA&COLOR as SK.KEYPRODUCT,
	 NUMEROPRODUCTODISPLAY, 
     NOMBREBUSQUEDA, 
     TIPOPRODUCTO, 
     NOMBRETIPOPRODUCTO, 
     PRODUCTRECID, 
     CATEGORYRECID, 
     CATEGORYHIERARCHYRECID, 
     CODARTICULO, 
     NOMBREPRODUCTO, 
     NOMBRECATEGORIA, 
     DESCGRUPODIMPRODUCTO, 
     PRODUCTDIMENSIONGROUPRECID, 
     INVENTTABLERECID, 
     DEFAULTDIMENSION, 
     NOMBREGRUPODIMPRODUCTO, 
     NOMBREGRUPODIMALMAC, 
     DESCGRUPODIMALMAC, 
     STORAGEDIMENSIONGROUPRECID, 
     NOMBREGRUPODIMSEGUIMIENTO, 
     DESCGRUPODIMSEGUIMIENTO, 
     PRODUCTINVENTDIMID, 
     EMPRESA, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     EMITIDO, 
     NOMBREEMITIDO, 
     SUBTIPOPRODUCTO, 
     NOMBRESUBTIPOPRODUCTO, 
     NOMBREJERARQUIACATEGORIA, 
     NUMEROPRODUCTO, 
     UBICACION, 
     SERIAL, 
     ALMACEN, 
     CODIGOBARRAS, 
     NUMEROVARIANTE, 
     COLOR, 
     ESTILO, 
     SITIO, 
     TALLA, 
     TRACKINGDIMENSIONGROUPRECID, 
     PRODUCTPARENT
FROM
[..\QVD\QST_MaestroProductos.QVD]
(qvd);


MasterProductAttributes:
LOAD
//LOAD AT_APARIENCIA_DETALLADA, 
//     AT_APARIENCIA_GENERAL, 
//     AT_BANDA_DE_PRECIO, 
//     AT_CLASIFICACION_INVENTARIO, 
//     AT_CLIMA, 
//     AT_COLECCION, 
//     AT_CUELLO, 
//     AT_DISENADOR, 
//     AT_GENERO, 
//     AT_GENERO_MATERIAL, 
//     AT_GRUPO_DE_PRODUCTOS, 
//     AT_LAVADO, 
//     AT_LINEA_MATERIAL, 
//     AT_MANGA, 
//     AT_MATERIAL_INSUMO, 
//     AT_NIVEL_DE_MODA, 
//     AT_OPERACION_USO, 
//     AT_PATRONISTA, 
//     AT_SILUETA, 
//     AT_TIPO_DE_ADQUISICION, 
//     AT_TIPO_DE_PRENDA, 
//     AT_TIPO_DE_PRODUCTO, 
//     AT_TIPOLOGIA_DE_TEJIDO, 
     ATVAL_APARIENCIA_DETALLADA, 
     ATVAL_APARIENCIA_GENERAL, 
     ATVAL_BANDA_DE_PRECIO, 
     ATVAL_CLASIFICACION_INVENTARIO, 
     ATVAL_CLIMA, 
     ATVAL_COLECCION, 
     ATVAL_CUELLO, 
     ATVAL_DISENADOR, 
     ATVAL_GENERO, 
     ATVAL_GENERO_MATERIAL, 
     ATVAL_GRUPO_DE_PRODUCTOS, 
     ATVAL_LAVADO, 
     ATVAL_LINEA_MATERIAL, 
     ATVAL_MANGA, 
     ATVAL_MATERIAL_INSUMO, 
     ATVAL_NIVEL_DE_MODA, 
     ATVAL_OPERACION_USO, 
     ATVAL_PATRONISTA, 
     ATVAL_SILUETA, 
     ATVAL_TIPO_DE_ADQUISICION, 
     ATVAL_TIPO_DE_PRENDA, 
     ATVAL_TIPO_DE_PRODUCTO, 
     ATVAL_TIPOLOGIA_DE_TEJIDO, 
     NOMBRECATEGORIA as NC, 
     CATEGORYRECID//, 
//     DATAAREAID, 
//     RECVERSION, 
//     PARTITION, 
//     RECID
FROM
[..\QVD\QST_MaestroProductosAtributes.QVD]
(qvd);

UNQUALIFY *;
///$tab Cartera
QUALIFY *;
UNQUALIFY IDCLIENTE;
CarteraCliente:
LOAD CUENTACLIENTE as IDCLIENTE, 
     FECHAFACTURA, 
     VALORFACTURADIVISATRANS, 
     VALORFACTURA, 
     IDFACTURA, 
     ULTIMAFECHALIQUIDACION, 
     ULTIMOASIENTOLIQUIDACION, 
     SALDOTOTAL, 
     FECHAVENCIMIENTO, 
     VALORDIVISALIQUIDADA, 
     VALORLIQUIDADO, 
     NOMBRECLIENTE, 
     SALDOVENCIDOTOTAL, 
     DIVISA, 
     CREATEDDATETIME, 
     CREATEDBY, 
     DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     SALDOTOTALDIVISA, 
     ESTADOFACTURA,
     NOMBREESTADOFACTURA, 
     CONDICIONPAGO, 
     DIASVENCIDOS, 
     VENCIDA,
     NOMBREVENCIDA, 
     SALDOCORRIENTETOTAL, 
     ASIENTOFACTURA, 
     SALESID,
     TIPOPAGO,
     DIMENSIONDEFAULTFACTSERV, 
     DIMENSIONDEFAULTSALES, 
     MODULOGENERACION,
     NOMBREMODULOGENERACION,
     PORCENTAJEPRONTOPAGO,
     DESCRIPCIONPRONTOPAGO,
     IDVENDEDOR,
     NOMBREVENDEDOR
FROM
[..\QVD\QST_Cartera.QVD]
(qvd);

UNQUALIFY *;
///$tab DefaultDimensions
QUALIFY *;
UNQUALIFY SK.DEFAULTDIMENSION;
DefaultDimensions:
LOAD DATAAREAID, 
     RECVERSION, 
     PARTITION, 
     RECID, 
     DEFAULTDIMENSION AS SK.DEFAULTDIMENSION, 
     DIMENSION_CENTRO_DE_COSTO, 
     DIMENSION_COLECCION, 
     DIMENSION_ESTRUCTURA_COMERCIAL, 
     DIMENSION_FLUJO_DE_EFECTIVO, 
     DIMENSION_LINEA, 
     DIMENSION_MAINACCOUNT, 
     DIMENSION_MARCA, 
     DIMENSION_PROYECTO, 
     DIMENSION_SUBLINEA, 
     DIMENSION_TERCERO, 
     DIMENSION_TIPO_DE_TIENDA, 
     DESC_CENTRO_DE_COSTO, 
     DESC_COLECCION, 
     DESC_ESTRUCTURA_COMERCIAL, 
     DESC_FLUJO_DE_EFECTIVO, 
     DESC_LINEA, 
     DESC_MAINACCOUNT, 
     DESC_MARCA, 
     DESC_PROYECTO, 
     DESC_SUBLINEA, 
     DESC_TERCERO, 
     DESC_TIPO_DE_TIENDA, 
     MODIFIEDDATETIME, 
     CREATEDDATETIME
FROM
[..\QVD\DefaulDimensions.QVD]
(qvd);

UNQUALIFY *;
